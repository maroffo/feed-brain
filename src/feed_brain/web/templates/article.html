{% extends "base.html" %}
{% block title %}{{ article.title }} - feed-brain{% endblock %}
{% block content %}
<article>
    <header>
        <div class="card-meta">
            {% if article.tier %}
            <span class="badge tier-{{ article.tier }}">{{ article.tier | tier_label }}</span>
            {% endif %}
            {% if article.category %}
            <span class="badge category">{{ article.category | category_label }}</span>
            {% endif %}
            {% if article.source_name %}
            <span class="source">{{ article.source_name }}</span>
            {% endif %}
        </div>
        <h2>{{ article.title }}</h2>
        {% if article.author %}
        <p class="author">by {{ article.author }}</p>
        {% endif %}
        <p><a href="{{ article.url }}" target="_blank" rel="noopener">Original article ‚Üó</a></p>
    </header>

    {% if article.summary %}
    <aside class="ai-analysis">
        <div class="summary-section">
            <h6 class="ai-label">AI Summary</h6>
            <p>{{ article.summary }}</p>
        </div>
        {% if article.reason %}
        <div class="reason-section">
            <h6 class="ai-label">Analysis & Reasoning</h6>
            <p class="reason-text">{{ article.reason }}</p>
        </div>
        {% endif %}
    </aside>
    {% endif %}

    <div class="article-content">
        {{ article.content | default("No content extracted.") | safe }}
    </div>

    <footer>
        <div class="feedback-buttons" id="feedback-{{ article.id }}">
            {% if article.feedback == "approved" %}
            <span class="feedback-done">Clipping created</span>
            {% elif article.feedback == "skipped" %}
            <span class="feedback-done">Skipped</span>
            {% else %}
            <button hx-post="/article/{{ article.id }}/feedback?feedback=approved"
                    hx-target="#feedback-{{ article.id }}"
                    hx-swap="innerHTML"
                    class="btn-sm outline">üëç Approve</button>
            <button hx-post="/article/{{ article.id }}/feedback?feedback=skipped"
                    hx-target="#feedback-{{ article.id }}"
                    hx-swap="innerHTML"
                    class="btn-sm outline secondary">üëé Skip</button>
            {% endif %}
        </div>
    </footer>
</article>

<nav class="article-nav">
    {% if prev_id %}
    <a href="/article/{{ prev_id }}{{ tier_param }}">‚Üê Previous</a>
    {% else %}
    <span></span>
    {% endif %}
    <a href="/{{ '?tier=' + tier_filter if tier_filter else '' }}">Back to feed</a>
    {% if next_id %}
    <a href="/article/{{ next_id }}{{ tier_param }}">Next ‚Üí</a>
    {% else %}
    <span></span>
    {% endif %}
</nav>
{% endblock %}
